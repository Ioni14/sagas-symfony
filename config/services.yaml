imports:
    - { resource: contexts/* }

services:
    _defaults:
        autowire: true
        autoconfigure: true
#        bind:
#            Symfony\Component\Messenger\Transport\Sender\SenderInterface $reliableSender: '@messenger.transport.outbox'

    Shared\Infrastructure\:
        resource: '../src/_Shared/Infrastructure'

#    Shared\Infrastructure\Messenger\OutboxProcessor:
#        autoconfigure: false
#        tags:
#            - { name: messenger.message_handler, handles: '*' }

#    app.messenger.handle_saga:
    messenger.middleware.handle_message:
        abstract: true
        class: Shared\Infrastructure\Messenger\HandleSagaMiddleware
        arguments:
            - !abstract defined in MessengerPass

    Shared\Application\SagaProviderInterface: '@Shared\Infrastructure\DoctrineSagaProvider'
